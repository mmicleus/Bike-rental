{"ast":null,"code":"import { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { Booking } from 'src/app/shared/booking.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/utility.service\";\nimport * as i2 from \"src/app/shared/data.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/authentication/auth.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nconst _c0 = [\"timeframes\"];\nfunction BookingFormComponent_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bike_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", bike_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", bike_r7, \" \");\n  }\n}\nfunction BookingFormComponent_span_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 18);\n    i0.ɵɵtext(1, \"A minimum quantity of 1 required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction BookingFormComponent_span_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 18);\n    i0.ɵɵtext(1, \"Only 9 available\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction BookingFormComponent_span_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 18);\n    i0.ɵɵtext(1, \"SELECT ABOVE\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction BookingFormComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\")(4, \"br\");\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"br\")(10, \"hr\")(11, \"br\");\n    i0.ɵɵelementStart(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function BookingFormComponent_div_31_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.addToCart());\n    });\n    i0.ɵɵtext(15, \"Add to cart\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"Quantity: \", ctx_r5.booking.quantity, \" @ \\u20AC\", ctx_r5.booking.price, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Date:\", ctx_r5.booking.date, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Time: \", ctx_r5.booking.time, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"Subtotal: \\u20AC\", ctx_r5.booking.cost, \"\");\n  }\n}\nfunction BookingFormComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"strong\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" has been successfully added to your cart \");\n    i0.ɵɵelementStart(4, \"p\", 22)(5, \"a\", 23);\n    i0.ɵɵlistener(\"click\", function BookingFormComponent_div_32_Template_a_click_5_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.viewCart());\n    });\n    i0.ɵɵtext(6, \"View Cart\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \" or \");\n    i0.ɵɵelementStart(8, \"a\", 23);\n    i0.ɵɵlistener(\"click\", function BookingFormComponent_div_32_Template_a_click_8_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.onAlertClose());\n    });\n    i0.ɵɵtext(9, \"continue shopping\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function BookingFormComponent_div_32_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.onAlertClose());\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.booking.model);\n  }\n}\nlet BookingFormComponent = /*#__PURE__*/(() => {\n  class BookingFormComponent {\n    constructor(utilityService, dataService, router, authService) {\n      this.utilityService = utilityService;\n      this.dataService = dataService;\n      this.router = router;\n      this.authService = authService;\n      this.form = new FormGroup({});\n      this.time = '10:00 am - 1:00pm';\n      this.booking = new Booking('Road Bike', 2, 35, 70, '2020-01-01', '10 am - 4pm');\n      this.notificationOn = false;\n    }\n    onTimeframeClicked(event) {\n      let elem = event.target;\n      (this.timeframes?.nativeElement).querySelectorAll('.timeframe').forEach(elem => elem.classList.remove('selected'));\n      elem.classList.add('selected');\n      this.time = elem.textContent;\n      this.createBooking();\n    }\n    ngOnInit() {\n      this.form = new FormGroup({\n        bikeOptions: new FormControl(null, Validators.required),\n        quantity: new FormControl(1, [Validators.required, Validators.min(1), Validators.max(9)]),\n        date: new FormControl(this.utilityService.getCurrentDate())\n      });\n      this.createBooking();\n      this.form.valueChanges.subscribe(value => {\n        this.createBooking();\n      });\n    }\n    minus() {\n      let quantityControl = this.form.get('quantity');\n      console.log(this.form);\n      this.form.patchValue({\n        quantity: this.utilityService.clampLow(quantityControl?.value - 1, 0)\n      });\n    }\n    plus() {\n      let quantityControl = this.form.get('quantity');\n      console.log(this.form);\n      this.form.patchValue({\n        quantity: quantityControl?.value + 1\n      });\n    }\n    lowerThanOne(control) {\n      if (control.value == 0) {\n        return {\n          quantityIsZero: true\n        };\n      }\n      return null;\n    }\n    createBooking() {\n      this.booking.model = this.form.get('bikeOptions')?.value;\n      this.booking.price = this.utilityService.getBikePrice(this.form.get('bikeOptions')?.value, this.bikes);\n      this.booking.quantity = this.form.get('quantity')?.value;\n      this.booking.cost = this.booking.price * this.booking.quantity;\n      this.booking.date = this.utilityService.getFormattedDate(this.form.get('date')?.value);\n      this.booking.time = this.time;\n      console.log(this.booking);\n    }\n    addToCart() {\n      if (!this.authService.account) {\n        this.router.navigate([\"/auth\"], {\n          queryParams: {\n            'alertMessage': 'You must log in!'\n          }\n        });\n        return;\n      }\n      this.dataService.addBooking({\n        ...this.booking\n      });\n      this.notificationOn = true;\n    }\n    onAlertClose() {\n      this.notificationOn = false;\n    }\n    viewCart() {\n      this.router.navigate(['/cart']);\n    }\n  }\n  BookingFormComponent.ɵfac = function BookingFormComponent_Factory(t) {\n    return new (t || BookingFormComponent)(i0.ɵɵdirectiveInject(i1.UtilityService), i0.ɵɵdirectiveInject(i2.DataService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.AuthService));\n  };\n  BookingFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BookingFormComponent,\n    selectors: [[\"app-booking-form\"]],\n    viewQuery: function BookingFormComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.timeframes = _t.first);\n      }\n    },\n    inputs: {\n      bikes: \"bikes\"\n    },\n    decls: 33,\n    vars: 12,\n    consts: [[1, \"container\"], [1, \"header\", \"gray-banner\"], [3, \"formGroup\"], [\"formControlName\", \"bikeOptions\", 1, \"form-select\", \"mt-5\"], [\"value\", \"select your bike\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"d-flex\", \"justify-content-between\"], [1, \"quantity-btn\", 3, \"click\"], [\"formControlName\", \"quantity\", \"type\", \"text\", \"size\", \"2\", 1, \"quantity\"], [\"type\", \"date\", \"id\", \"start\", \"name\", \"trip-start\", \"formControlName\", \"date\", 3, \"min\", \"max\"], [1, \"timeframes\"], [\"timeframes\", \"\"], [1, \"timeframe\", \"selected\", 3, \"disabled\", \"click\"], [1, \"timeframe\", 3, \"disabled\", \"click\"], [\"class\", \"err-alert\", 4, \"ngIf\"], [\"class\", \"receipt\", 4, \"ngIf\"], [\"class\", \"alert alert-warning alert-dismissible fade show\", \"role\", \"alert\", 4, \"ngIf\"], [3, \"value\"], [1, \"err-alert\"], [1, \"receipt\"], [1, \"add-btn\", 3, \"click\"], [\"role\", \"alert\", 1, \"alert\", \"alert-warning\", \"alert-dismissible\", \"fade\", \"show\"], [1, \"alert-btns\"], [3, \"click\"], [\"type\", \"button\", \"data-bs-dismiss\", \"alert\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"click\"]],\n    template: function BookingFormComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtext(2, \"Book here\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"form\", 2)(4, \"select\", 3)(5, \"option\", 4);\n        i0.ɵɵtext(6, \"SELECT YOUR BIKE\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(7, BookingFormComponent_option_7_Template, 2, 2, \"option\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(8, \"br\");\n        i0.ɵɵelementStart(9, \"div\", 6)(10, \"label\");\n        i0.ɵɵtext(11, \"Quantity\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\")(13, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_13_listener() {\n          return ctx.minus();\n        });\n        i0.ɵɵtext(14, \"-\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"input\", 8);\n        i0.ɵɵelementStart(16, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_16_listener() {\n          return ctx.plus();\n        });\n        i0.ɵɵtext(17, \"+\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(18, \"br\")(19, \"input\", 9);\n        i0.ɵɵelementStart(20, \"div\", 10, 11)(22, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_22_listener($event) {\n          return ctx.onTimeframeClicked($event);\n        });\n        i0.ɵɵtext(23, \" 10:00 am - 1:00pm \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"button\", 13);\n        i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_24_listener($event) {\n          return ctx.onTimeframeClicked($event);\n        });\n        i0.ɵɵtext(25, \" 10:00 am - 4:30pm \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"button\", 13);\n        i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_26_listener($event) {\n          return ctx.onTimeframeClicked($event);\n        });\n        i0.ɵɵtext(27, \" 1:30 pm - 4:30pm \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(28, BookingFormComponent_span_28_Template, 2, 0, \"span\", 14);\n        i0.ɵɵtemplate(29, BookingFormComponent_span_29_Template, 2, 0, \"span\", 14);\n        i0.ɵɵtemplate(30, BookingFormComponent_span_30_Template, 2, 0, \"span\", 14);\n        i0.ɵɵtemplate(31, BookingFormComponent_div_31_Template, 16, 5, \"div\", 15);\n        i0.ɵɵtemplate(32, BookingFormComponent_div_32_Template, 11, 1, \"div\", 16);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        let tmp_4_0;\n        let tmp_5_0;\n        let tmp_6_0;\n        let tmp_7_0;\n        let tmp_8_0;\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"formGroup\", ctx.form);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.utilityService.getBikeOptions(ctx.bikes));\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"min\", ctx.utilityService.getCurrentDate())(\"max\", ctx.utilityService.getLaterDate(30));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", !((tmp_4_0 = ctx.form.get(\"bikeOptions\")) == null ? null : tmp_4_0.valid));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !((tmp_5_0 = ctx.form.get(\"bikeOptions\")) == null ? null : tmp_5_0.valid));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !((tmp_6_0 = ctx.form.get(\"bikeOptions\")) == null ? null : tmp_6_0.valid));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx.form.get(\"quantity\")) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"min\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (tmp_8_0 = ctx.form.get(\"quantity\")) == null ? null : tmp_8_0.errors == null ? null : tmp_8_0.errors[\"max\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.form.touched);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.form.touched && ctx.form.valid && !ctx.notificationOn);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.notificationOn);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.ɵNgNoValidate, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i6.DefaultValueAccessor, i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.FormGroupDirective, i6.FormControlName],\n    styles: [\".header[_ngcontent-%COMP%]{width:100%;margin:auto;font-size:2rem}.quantity[_ngcontent-%COMP%]{border:1px solid lightgray;padding:.5rem}.quantity[_ngcontent-%COMP%]:focus{outline:none;border:1px solid lightgray}.quantity-btn[_ngcontent-%COMP%]{border:1px solid lightgray;padding:.5rem 1rem}.timeframes[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;row-gap:1rem;column-gap:1rem;width:100%;margin-top:2rem}.timeframe[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid lightgray}.timeframe.selected[_ngcontent-%COMP%]:not([disabled]){background-color:var(--clr-secondary);border:1px solid var(--clr-secondary);color:var(--clr-primary)}.err-alert[_ngcontent-%COMP%]{color:red}.add-btn[_ngcontent-%COMP%]{padding:.6rem 1rem;background-color:var(--clr-secondary);color:var(--clr-primary);font-weight:700;text-align:center;outline:none;border:none}.alert-warning[_ngcontent-%COMP%]{margin-top:2rem}.alert-warning[_ngcontent-%COMP%]   .alert-btns[_ngcontent-%COMP%]{color:#000;margin-top:1rem}.alert-btns[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}\"]\n  });\n  return BookingFormComponent;\n})();\nexport { BookingFormComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}